<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="Up" href="Postgresql.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of class methods" rel=Appendix href="index_methods.html">
<link title="Index of classes" rel=Appendix href="index_classes.html">
<link title="Index of class types" rel=Appendix href="index_class_types.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Postgresql" rel="Chapter" href="Postgresql.html"><title>Postgresql.connection</title>
</head>
<body>
<div class="navbar">&nbsp;<a class="up" href="Postgresql.html" title="Postgresql">Up</a>
&nbsp;</div>
<h1>Class <a href="type_Postgresql.connection.html">Postgresql.connection</a></h1>

<pre><span name="TYPEconnection"><span class="keyword">class</span> connection</span> : <code class="type">?host:string -> ?hostaddr:string -> ?port:string -> ?dbname:string -> ?user:string -> ?password:string -> ?options:string -> ?tty:string -> ?requiressl:string -> ?conninfo:string -> ?startonly:bool -> unit -> </code><code class="code">object</code> <a href="Postgresql.connection-c.html">..</a> <code class="code">end</code></pre><div class="info class top">
Class of connections.
<p>

    When <code class="code">conninfo</code> is given, it will be used instead of all other
    optional arguments.<br>
<b>Raises</b> <code>Error</code> if there is a connection failure.<br>
</div>
<div class="param_info"><code class="code">startonly</code> : If true, initiate a non-blocking connect procedure, which
      involves cooperative calls to <a href="Postgresql.connection-c.html#METHODconnect_poll"><code class="code">Postgresql.connection.connect_poll</code></a> before the connection is
      usable.</div>
<hr width="100%">

<pre><span id="METHODfinish"><span class="keyword">method</span> finish</span> : <code class="type">unit</code></pre><div class="info ">
<code class="code">#finish</code> closes the connection.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODtry_reset"><span class="keyword">method</span> try_reset</span> : <code class="type">unit</code></pre><div class="info ">
<code class="code">#try_reset</code> tries to reset the connection if it is bad. If
      resetting fails, the <code class="code">error</code> exception will be raised with
      <code class="code">Connection_failure</code>.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODreset"><span class="keyword">method</span> reset</span> : <code class="type">unit</code></pre><div class="info ">
<code class="code">#reset</code> resets the connection.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>
<h2 id="2_AsynchronousNotification">Asynchronous Notification</h2>
<pre><span id="METHODnotifies"><span class="keyword">method</span> notifies</span> : <code class="type"><a href="Postgresql.Notification.html#TYPEt">Notification.t</a> option</code></pre><div class="info ">
<code class="code">#notifies</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> <code class="code">Some notification</code> if available (<code class="code">None</code> otherwise).<br>
</div>
<h2 id="2_ControlFunctions">Control Functions</h2>
<pre><span id="METHODset_notice_processor"><span class="keyword">method</span> set_notice_processor</span> : <code class="type">(string -> unit) -> unit</code></pre><div class="info ">
<code class="code">#set_notice_processor</code> controls reporting of notice and warning
      messages generated by a connection.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>
<h2 id="2_Accessors">Accessors</h2>
<pre><span id="METHODdb"><span class="keyword">method</span> db</span> : <code class="type">string</code></pre><div class="info ">
<code class="code">#db</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> database name of the connection.<br>
</div>

<pre><span id="METHODuser"><span class="keyword">method</span> user</span> : <code class="type">string</code></pre><div class="info ">
<code class="code">#user</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> user name of the connection.<br>
</div>

<pre><span id="METHODpass"><span class="keyword">method</span> pass</span> : <code class="type">string</code></pre><div class="info ">
<code class="code">#pass</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> password of the connection.<br>
</div>

<pre><span id="METHODhost"><span class="keyword">method</span> host</span> : <code class="type">string</code></pre><div class="info ">
<code class="code">#host</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> server host name of the connection.<br>
</div>

<pre><span id="METHODport"><span class="keyword">method</span> port</span> : <code class="type">string</code></pre><div class="info ">
<code class="code">#port</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> port of the connection.<br>
</div>

<pre><span id="METHODtty"><span class="keyword">method</span> tty</span> : <code class="type">string</code></pre><div class="info ">
<code class="code">#tty</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> debug tty of the connection.<br>
</div>

<pre><span id="METHODoptions"><span class="keyword">method</span> options</span> : <code class="type">string</code></pre><div class="info ">
<code class="code">#options</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> backend options of the connection.<br>
</div>

<pre><span id="METHODstatus"><span class="keyword">method</span> status</span> : <code class="type"><a href="Postgresql.html#TYPEconnection_status">connection_status</a></code></pre><div class="info ">
<code class="code">#status</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> current connection status.<br>
</div>

<pre><span id="METHODerror_message"><span class="keyword">method</span> error_message</span> : <code class="type">string</code></pre><div class="info ">
<code class="code">#error_message</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> most recent error message of the connection.<br>
</div>

<pre><span id="METHODbackend_pid"><span class="keyword">method</span> backend_pid</span> : <code class="type">int</code></pre><div class="info ">
<code class="code">#backend</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> process id of the backend server of the connection.<br>
</div>

<pre><span id="METHODserver_version"><span class="keyword">method</span> server_version</span> : <code class="type">int * int * int</code></pre><h2 id="2_CommandsandQueries">Commands and Queries</h2>
<pre><span id="METHODempty_result"><span class="keyword">method</span> empty_result</span> : <code class="type"><a href="Postgresql.html#TYPEresult_status">result_status</a> -> <a href="Postgresql.result-c.html">result</a></code></pre><div class="info ">
<code class="code">empty_result stat</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> dummy result with a given status <code class="code">stat</code>.<br>
</div>

<pre><span id="METHODexec"><span class="keyword">method</span> exec</span> : <code class="type">?expect:<a href="Postgresql.html#TYPEresult_status">result_status</a> list -><br>       ?params:string array -><br>       ?binary_params:bool array -> string -> <a href="Postgresql.result-c.html">result</a></code></pre><div class="info ">
<code class="code">exec ?expect ?params ?binary_params query</code> synchronous execution
      of query or command <code class="code">query</code>.  The result status will be checked
      against all elements in <code class="code">expect</code>.  If <code class="code">expect</code> is not empty and if
      there is no match, the exception <code class="code">Unexpected_status</code> will be raised.
<p>

      Additional query parameters can be passed in the <code class="code">params</code> array.
      They must not be escaped and they can be referred to in <code class="code">query</code>
      as $1, $2, ...  The value <code class="code">null</code> can be used in the <code class="code">params</code>
      array to denote an SQL NULL. It is possible to specify that some
      of the query parameters are passed as binary strings using the
      <code class="code">binary_params</code> array.
<p>

      If no (or an empty) query parameter is passed, it is possible to
      emit several commands with a single call.<br>
<b>Raises</b><ul><li><code>Error</code> if there is a connection error.</li>
<li><code>Error</code> if there is an unexpected result status.</li>
</ul>
<b>Returns</b> result of query.<br>
</div>
<div class="param_info"><code class="code">expect</code> : default = []</div>
<div class="param_info"><code class="code">params</code> : default = <code class="code">||</code></div>
<div class="param_info"><code class="code">binary_params</code> : default = <code class="code">||</code></div>

<pre><span id="METHODprepare"><span class="keyword">method</span> prepare</span> : <code class="type">string -> string -> <a href="Postgresql.result-c.html">result</a></code></pre><div class="info ">
<code class="code">prepare stm_name query</code> creates a prepared query named <code class="code">stm_name</code>
      which will execute the query or command <code class="code">query</code> when passed to
      <code class="code">#exec_prepared</code>.<br>
</div>

<pre><span id="METHODexec_prepared"><span class="keyword">method</span> exec_prepared</span> : <code class="type">?expect:<a href="Postgresql.html#TYPEresult_status">result_status</a> list -><br>       ?params:string array -><br>       ?binary_params:bool array -> string -> <a href="Postgresql.result-c.html">result</a></code></pre><div class="info ">
<code class="code">exec_prepared ?expect ?params ?binary_params stm_name</code> acts as
      <code class="code">#exec</code>, except executes the prepared query <code class="code">stm_name</code>.<br>
</div>

<pre><span id="METHODdescribe_prepared"><span class="keyword">method</span> describe_prepared</span> : <code class="type">string -> <a href="Postgresql.result-c.html">result</a></code></pre><div class="info ">
<code class="code">#describe_prepared stm_name</code> submits a request to obtain
      information about the specified prepared statement, and waits for
      completion.  <a href="Postgresql.connection-c.html#METHODdescribe_prepared"><code class="code">Postgresql.connection.describe_prepared</code></a> allows an application to obtain
      information about a previously prepared statement.  The <code class="code">stm_name</code>
      parameter can be the empty string ("") to reference the unnamed
      statement, otherwise it must be the name of an existing prepared
      statement.  On success, a <a href="Postgresql.result-c.html"><code class="code">Postgresql.result</code></a> with status <code class="code">Command_ok</code> is
      returned.  The methods <a href="Postgresql.result-c.html#METHODnparams"><code class="code">Postgresql.result.nparams</code></a> and <a href="Postgresql.result-c.html#METHODparamtype"><code class="code">Postgresql.result.paramtype</code></a>
      of the class <code class="code">result</code> can be used to obtain information about
      the parameters of the prepared statement, and the methods
      <a href="Postgresql.result-c.html#METHODnfields"><code class="code">Postgresql.result.nfields</code></a>, <a href="Postgresql.result-c.html#METHODfname"><code class="code">Postgresql.result.fname</code></a> and <a href="Postgresql.result-c.html#METHODftype"><code class="code">Postgresql.result.ftype</code></a> provide
      information about the result columns (if any) of the statement.
<p>

      To prepare a statement use the SQL command PREPARE.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>See also</b> <a href="http://www.postgresql.org/docs/8.3/interactive/sql-prepare.html">PostgreSQL documentation about <code class="code">PREPARE</code></a><br>
</div>

<pre><span id="METHODsend_query"><span class="keyword">method</span> send_query</span> : <code class="type">?params:string array -> ?binary_params:bool array -> string -> unit</code></pre><div class="info ">
<code class="code">send_query ?params ?binary_params query</code> asynchronous execution
      of query or command <code class="code">query</code>.
<p>

      Additional query parameters can be passed in the <code class="code">params</code> array.
      They must not be escaped and they can be referred to in <code class="code">query</code>
      as $1, $2, ...   The value <code class="code">null</code> can be used in the <code class="code">params</code>
      array to denote an SQL NULL. It is possible to specify that some
      of the query parameters are passed as binary strings using the
      <code class="code">binary_params</code> array.
<p>

      If no (or an empty) query parameter is passed, it is possible to
      emit several commands with a single call.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>
<div class="param_info"><code class="code">params</code> : default = <code class="code">||</code></div>
<div class="param_info"><code class="code">binary_params</code> : default = <code class="code">||</code></div>

<pre><span id="METHODsend_prepare"><span class="keyword">method</span> send_prepare</span> : <code class="type">string -> string -> unit</code></pre><div class="info ">
<code class="code">#send_prepare stm_name query</code> sends a query preparation without waiting
      for the result.  This does the same as <a href="Postgresql.connection-c.html#METHODprepare"><code class="code">Postgresql.connection.prepare</code></a> except that the status
      is reported by <a href="Postgresql.connection-c.html#METHODget_result"><code class="code">Postgresql.connection.get_result</code></a> when available.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODsend_query_prepared"><span class="keyword">method</span> send_query_prepared</span> : <code class="type">?params:string array -> ?binary_params:bool array -> string -> unit</code></pre><div class="info ">
<code class="code">#send_query_prepared ?params ?binary_params stm_name</code> is an
      asynchronous version of <code class="code">query_prepared</code>.  The semantics is otherwise
      the same, and the result is reported by <a href="Postgresql.connection-c.html#METHODget_result"><code class="code">Postgresql.connection.get_result</code></a> when available.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>
<div class="param_info"><code class="code">params</code> : default = <code class="code">||</code></div>
<div class="param_info"><code class="code">binary_params</code> : default = <code class="code">||</code></div>

<pre><span id="METHODsend_describe_prepared"><span class="keyword">method</span> send_describe_prepared</span> : <code class="type">string -> unit</code></pre><div class="info ">
<code class="code">#send_describe_prepared stm_name</code> sends a request for a description of
      a prepared query without waiting for the result.  The result must be
      fetched with <a href="Postgresql.connection-c.html#METHODget_result"><code class="code">Postgresql.connection.get_result</code></a> when it becomes available.  Otherwise it
      does the same as <a href="Postgresql.connection-c.html#METHODdescribe_prepared"><code class="code">Postgresql.connection.describe_prepared</code></a>.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODsend_describe_portal"><span class="keyword">method</span> send_describe_portal</span> : <code class="type">string -> unit</code></pre><div class="info ">
<code class="code">#send_describe_portal portal_name</code> sends a request for a description of
      the named portal.  The result must be fetched with <a href="Postgresql.connection-c.html#METHODget_result"><code class="code">Postgresql.connection.get_result</code></a>.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODset_single_row_mode"><span class="keyword">method</span> set_single_row_mode</span> : <code class="type">unit</code></pre><div class="info ">
<code class="code">#set_single_row_mode</code> called right after <a href="Postgresql.connection-c.html#METHODsend_query"><code class="code">Postgresql.connection.send_query</code></a> or a sibling
      function causes the returned rows to be split into individual results.<br>
</div>

<pre><span id="METHODget_result"><span class="keyword">method</span> get_result</span> : <code class="type"><a href="Postgresql.result-c.html">result</a> option</code></pre><div class="info ">
<code class="code">get_result</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> <code class="code">Some result</code> of an asynchronous query if
      available or <code class="code">None</code>.<br>
</div>
<h2 id="2_Copyoperations">Copy operations</h2><h2 id="2_Lowlevel">Low level</h2>
<pre><span id="METHODgetline"><span class="keyword">method</span> getline</span> : <code class="type">?pos:int -> ?len:int -> Bytes.t -> <a href="Postgresql.html#TYPEgetline_result">getline_result</a></code></pre><div class="info ">
<code class="code">getline ?pos ?len buf</code> reads a newline-terminated line of at most
      <code class="code">len</code> characters into <code class="code">buf</code> starting at position <code class="code">pos</code>.<br>
<b>Raises</b><ul><li><code>Invalid_argument</code> if the buffer parameters are invalid.</li>
<li><code>Error</code> if there is a connection error.</li>
</ul>
<b>Returns</b> getline_result<br>
</div>
<div class="param_info"><code class="code">pos</code> : default = 0</div>
<div class="param_info"><code class="code">len</code> : default = Bytes.length buf - pos</div>

<pre><span id="METHODgetline_async"><span class="keyword">method</span> getline_async</span> : <code class="type">?pos:int -> ?len:int -> Bytes.t -> <a href="Postgresql.html#TYPEgetline_async_result">getline_async_result</a></code></pre><div class="info ">
<code class="code">getline_async ?pos ?len buf</code> reads a newline-terminated line of
      at most <code class="code">len</code> characters into <code class="code">buf</code> starting at position <code class="code">pos</code>
      (asynchronously).  No need to call <code class="code">endcopy</code> after receiving
      <code class="code">EndOfData</code>.<br>
<b>Raises</b><ul><li><code>Invalid_argument</code> if the buffer parameters are invalid.</li>
<li><code>Error</code> if there is a connection error.</li>
</ul>
<b>Returns</b> getline_async_result<br>
</div>
<div class="param_info"><code class="code">pos</code> : default = 0</div>
<div class="param_info"><code class="code">len</code> : default = Bytes.length buf - pos</div>

<pre><span id="METHODputline"><span class="keyword">method</span> putline</span> : <code class="type">string -> unit</code></pre><div class="info ">
<code class="code">putline str</code> sends <code class="code">str</code> to backend server. Don't use this method
      for binary data, use putnbytes instead!<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODputnbytes"><span class="keyword">method</span> putnbytes</span> : <code class="type">?pos:int -> ?len:int -> string -> unit</code></pre><div class="info ">
<code class="code">putnbytes ?pos ?len buf</code> sends the substring of <code class="code">buf</code> of length
      <code class="code">len</code> starting at <code class="code">pos</code> to backend server (use this method for
      binary data).<br>
<b>Raises</b><ul><li><code>Invalid_argument</code> if the buffer parameters are invalid.</li>
<li><code>Error</code> if there is a connection error.</li>
</ul>
</div>
<div class="param_info"><code class="code">pos</code> : default = 0</div>
<div class="param_info"><code class="code">len</code> : default = String.length buf - pos</div>

<pre><span id="METHODendcopy"><span class="keyword">method</span> endcopy</span> : <code class="type">unit</code></pre><div class="info ">
<code class="code">endcopy</code> synchronizes with the backend.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>
<h2 id="2_Highlevel">High level</h2>
<pre><span id="METHODcopy_out"><span class="keyword">method</span> copy_out</span> : <code class="type">(string -> unit) -> unit</code></pre><div class="info ">
<code class="code">copy_out f</code> applies <code class="code">f</code> to each line returned by backend server.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODcopy_out_channel"><span class="keyword">method</span> copy_out_channel</span> : <code class="type">Pervasives.out_channel -> unit</code></pre><div class="info ">
<code class="code">copy_out_channel ch</code> sends each line returned by backend server
      to output channel <code class="code">ch</code>.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODcopy_in_channel"><span class="keyword">method</span> copy_in_channel</span> : <code class="type">Pervasives.in_channel -> unit</code></pre><div class="info ">
<code class="code">copy_in_channel ch</code> sends each line in input channel <code class="code">ch</code> to
      backend server.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>
<h2 id="2_Asynchronousoperationsandnonblockingmode">Asynchronous operations and non blocking mode</h2>
<pre><span id="METHODconnect_poll"><span class="keyword">method</span> connect_poll</span> : <code class="type"><a href="Postgresql.html#TYPEpolling_status">polling_status</a></code></pre><div class="info ">
After creating a connection with <code class="code">~startonly:true</code>, <a href="Postgresql.connection-c.html#METHODconnect_poll"><code class="code">Postgresql.connection.connect_poll</code></a>
      must be called a number of times before the connection can be used.
      The precise procedure is described in the libpq manual, but the following
      code should capture the idea, assuming monadic concurrency primitives
      <code class="code">return</code> and <code class="code">&gt;&gt;=</code> along with polling functions <code class="code">wait_for_read</code> and
      <code class="code">wait_for_write</code>:
      <pre class="codepre"><code class="code">        let my_async_connect () =
          let c = new connection () in
          let rec establish_connection = function
            | Polling_failed | Polling_ok -&gt; return c
            | Polling_reading -&gt; wait_for_read c#socket &gt;&gt;= fun () -&gt;
                                 establish_connection c#connect_poll
            | Polling_writing -&gt; wait_for_write c#socket &gt;&gt;= fun () -&gt;
                                 establish_connection c#connect_poll in
          establish_connection Polling_writing
      </code></pre>
      See also <code class="code">examples/async.ml</code>.<br>
</div>

<pre><span id="METHODreset_start"><span class="keyword">method</span> reset_start</span> : <code class="type">bool</code></pre><div class="info ">
An asynchronous variant of <a href="Postgresql.connection-c.html#METHODreset"><code class="code">Postgresql.connection.reset</code></a>.  Use <a href="Postgresql.connection-c.html#METHODreset_poll"><code class="code">Postgresql.connection.reset_poll</code></a> to
      finish re-establishing the connection.<br>
</div>

<pre><span id="METHODreset_poll"><span class="keyword">method</span> reset_poll</span> : <code class="type"><a href="Postgresql.html#TYPEpolling_status">polling_status</a></code></pre><div class="info ">
Used analogously to <a href="Postgresql.connection-c.html#METHODconnect_poll"><code class="code">Postgresql.connection.connect_poll</code></a> after calling <a href="Postgresql.connection-c.html#METHODreset_start"><code class="code">Postgresql.connection.reset_start</code></a>.<br>
</div>

<pre><span id="METHODset_nonblocking"><span class="keyword">method</span> set_nonblocking</span> : <code class="type">bool -> unit</code></pre><div class="info ">
<code class="code">set_nonblocking b</code> sets state of the connection to nonblocking if
      <code class="code">b</code> is true and to blocking otherwise.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODis_nonblocking"><span class="keyword">method</span> is_nonblocking</span> : <code class="type">bool</code></pre><div class="info ">
<code class="code">is_nonblocking</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> the blocking status of the connection.<br>
</div>

<pre><span id="METHODconsume_input"><span class="keyword">method</span> consume_input</span> : <code class="type">unit</code></pre><div class="info ">
<code class="code">consume_input</code> consume any available input from backend.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODis_busy"><span class="keyword">method</span> is_busy</span> : <code class="type">bool</code></pre><div class="info ">
<code class="code">is_busy</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> busy status of a query.<br>
</div>

<pre><span id="METHODflush"><span class="keyword">method</span> flush</span> : <code class="type"><a href="Postgresql.html#TYPEflush_status">flush_status</a></code></pre><div class="info ">
<code class="code">flush</code> attempts to flush any data queued to the backend.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODsocket"><span class="keyword">method</span> socket</span> : <code class="type">int</code></pre><div class="info ">
<code class="code">socket</code> obtains the file descriptor for the backend connection
      socket as an integer.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODrequest_cancel"><span class="keyword">method</span> request_cancel</span> : <code class="type">unit</code></pre><div class="info ">
<code class="code">request_cancel</code> requests that PostgreSQL abandon processing of
      the current command.<br>
<b>Raises</b> <code>Error</code> if there is a connection or cancel error.<br>
</div>
<h2 id="2_Largeobjects">Large objects</h2>
<pre><span id="METHODlo_creat"><span class="keyword">method</span> lo_creat</span> : <code class="type"><a href="Postgresql.html#TYPEoid">oid</a></code></pre><div class="info ">
<code class="code">lo_creat</code> creates a new large object and returns its oid.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODlo_import"><span class="keyword">method</span> lo_import</span> : <code class="type">string -> <a href="Postgresql.html#TYPEoid">oid</a></code></pre><div class="info ">
<code class="code">lo_import filename</code> imports an operating system file given by
      <code class="code">filename</code> as a large object.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODlo_export"><span class="keyword">method</span> lo_export</span> : <code class="type"><a href="Postgresql.html#TYPEoid">oid</a> -> string -> unit</code></pre><div class="info ">
<code class="code">lo_export oid filename</code> exports the large object given by <code class="code">oid</code>
      to an operating system file given by <code class="code">filename</code>.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODlo_open"><span class="keyword">method</span> lo_open</span> : <code class="type"><a href="Postgresql.html#TYPEoid">oid</a> -> <a href="Postgresql.html#TYPElarge_object">large_object</a></code></pre><div class="info ">
<code class="code">lo_open oid</code> opens the large object given by <code class="code">oid</code> for reading and
      writing.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODlo_write"><span class="keyword">method</span> lo_write</span> : <code class="type">?pos:int -> ?len:int -> string -> <a href="Postgresql.html#TYPElarge_object">large_object</a> -> unit</code></pre><div class="info ">
<code class="code">lo_write ?pos ?len buf lo</code> writes <code class="code">len</code> bytes of buffer <code class="code">buf</code>
      starting at position <code class="code">pos</code> to large object <code class="code">lo</code>.<br>
<b>Raises</b><ul><li><code>Invalid_argument</code> if the buffer parameters are invalid.</li>
<li><code>Error</code> if <code class="code">len</code> bytes could not be written.</li>
<li><code>Error</code> if there is a connection error.</li>
</ul>
</div>
<div class="param_info"><code class="code">pos</code> : default = 0</div>
<div class="param_info"><code class="code">len</code> : default = String.length buf - pos</div>

<pre><span id="METHODlo_write_ba"><span class="keyword">method</span> lo_write_ba</span> : <code class="type">?pos:int -><br>       ?len:int -><br>       (char, Bigarray.int8_unsigned_elt, Bigarray.c_layout) Bigarray.Array1.t -><br>       <a href="Postgresql.html#TYPElarge_object">large_object</a> -> unit</code></pre><div class="info ">
As <code class="code">lo_write</code>, but performs a zero-copy write from the given Bigarray.<br>
</div>

<pre><span id="METHODlo_read"><span class="keyword">method</span> lo_read</span> : <code class="type"><a href="Postgresql.html#TYPElarge_object">large_object</a> -> ?pos:int -> ?len:int -> Bytes.t -> int</code></pre><div class="info ">
<code class="code">lo_read lo ?pos ?len buf</code> reads <code class="code">len</code> bytes from large object <code class="code">lo</code>
      to buffer <code class="code">buf</code> starting at position <code class="code">pos</code>.<br>
<b>Raises</b><ul><li><code>Invalid_argument</code> if the buffer parameters are invalid.</li>
<li><code>Error</code> if <code class="code">len</code> bytes could not be read.</li>
<li><code>Error</code> if there is a connection error.</li>
</ul>
</div>
<div class="param_info"><code class="code">pos</code> : default = 0</div>
<div class="param_info"><code class="code">len</code> : default = Bytes.length buf - pos</div>

<pre><span id="METHODlo_read_ba"><span class="keyword">method</span> lo_read_ba</span> : <code class="type"><a href="Postgresql.html#TYPElarge_object">large_object</a> -><br>       ?pos:int -><br>       ?len:int -><br>       (char, Bigarray.int8_unsigned_elt, Bigarray.c_layout) Bigarray.Array1.t -><br>       int</code></pre><div class="info ">
As <code class="code">lo_read</code>, but performs a zero-copy read into the given Bigarray.<br>
</div>

<pre><span id="METHODlo_seek"><span class="keyword">method</span> lo_seek</span> : <code class="type">?pos:int -> ?whence:<a href="Postgresql.html#TYPEseek_cmd">seek_cmd</a> -> <a href="Postgresql.html#TYPElarge_object">large_object</a> -> unit</code></pre><div class="info ">
<code class="code">lo_seek ?pos ?whence lo</code> seeks read/write position <code class="code">pos</code> in
      large object <code class="code">lo</code> relative to the start, current read/write
      position, or end of the object (<code class="code">whence</code> is SEEK_SET, SEEK_CUR,
      SEEK_END respectively).<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>
<div class="param_info"><code class="code">pos</code> : default = 0</div>
<div class="param_info"><code class="code">whence</code> : default = <code class="code">SEEK_SET</code></div>

<pre><span id="METHODlo_tell"><span class="keyword">method</span> lo_tell</span> : <code class="type"><a href="Postgresql.html#TYPElarge_object">large_object</a> -> int</code></pre><div class="info ">
<code class="code">lo_tell lo</code><br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
<b>Returns</b> current read/write position of large object <code class="code">lo</code>.<br>
</div>

<pre><span id="METHODlo_close"><span class="keyword">method</span> lo_close</span> : <code class="type"><a href="Postgresql.html#TYPElarge_object">large_object</a> -> unit</code></pre><div class="info ">
<code class="code">lo_close lo</code> closes large object <code class="code">lo</code>.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>

<pre><span id="METHODlo_unlink"><span class="keyword">method</span> lo_unlink</span> : <code class="type"><a href="Postgresql.html#TYPEoid">oid</a> -> unit</code></pre><div class="info ">
<code class="code">lo_unlink oid</code> removes the large object specified by <code class="code">oid</code> from the
      database.<br>
<b>Raises</b> <code>Error</code> if there is a connection error.<br>
</div>
<h2 id="2_Escaping">Escaping</h2>
<pre><span id="METHODescape_string"><span class="keyword">method</span> escape_string</span> : <code class="type">?pos:int -> ?len:int -> string -> string</code></pre><div class="info ">
<code class="code">escape_string ?pos ?len str</code> escapes ASCII-substring <code class="code">str</code>
      of length <code class="code">len</code> starting at position <code class="code">pos</code> for use within SQL.<br>
</div>
<div class="param_info"><code class="code">pos</code> : default = 0</div>
<div class="param_info"><code class="code">len</code> : default = String.length str - pos</div>

<pre><span id="METHODescape_bytea"><span class="keyword">method</span> escape_bytea</span> : <code class="type">?pos:int -> ?len:int -> string -> string</code></pre><div class="info ">
<code class="code">escape_bytea ?pos ?len str</code> escapes binary substring <code class="code">str</code>
      of length <code class="code">len</code> starting at position <code class="code">pos</code> for use within SQL.<br>
</div>
<div class="param_info"><code class="code">pos</code> : default = 0</div>
<div class="param_info"><code class="code">len</code> : default = String.length str - pos</div>
</body></html>